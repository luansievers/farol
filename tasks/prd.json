{
  "name": "Radar de Contratos",
  "description": "Infraestrutura cívica que analisa automaticamente contratos públicos da Prefeitura de São Paulo, transformando documentos técnicos em informações acessíveis com AI.",
  "branchName": "ralph/radar-de-contratos",
  "userStories": [
    {
      "id": "US-001",
      "title": "Setup do projeto e estrutura base",
      "description": "Como desenvolvedor, quero um projeto Node/TypeScript configurado com as dependências essenciais para começar o desenvolvimento.",
      "acceptanceCriteria": [
        "Projeto inicializado com pnpm",
        "TypeScript configurado com strict mode",
        "ESLint + Prettier configurados",
        "Estrutura de pastas definida (src/modules, src/shared, etc.)",
        "Scripts de dev, build, typecheck, lint no package.json",
        "README com instruções de setup",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "",
      "dependsOn": [],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-002",
      "title": "Configuração do banco de dados PostgreSQL",
      "description": "Como desenvolvedor, quero o banco PostgreSQL configurado com migrations para armazenar contratos e metadados.",
      "acceptanceCriteria": [
        "Docker Compose com PostgreSQL para desenvolvimento local",
        "ORM configurado (Prisma ou TypeORM)",
        "Schema inicial: contratos, fornecedores, orgaos, aditivos, anomalias",
        "Migration inicial criada e aplicável",
        "Seed com dados de exemplo para testes",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-001"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-003",
      "title": "Configuração de cloud storage para documentos",
      "description": "Como desenvolvedor, quero integração com cloud storage (S3-compatible) para armazenar PDFs originais dos contratos.",
      "acceptanceCriteria": [
        "Módulo de storage abstrato (interface que suporta S3, GCS, MinIO)",
        "Implementação para S3/MinIO (dev local)",
        "Funções: upload, download, getSignedUrl",
        "Variáveis de ambiente para configuração",
        "Testes unitários do módulo",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-001"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-004",
      "title": "Crawler do Portal de Transparência SP - Listagem",
      "description": "Como sistema, quero coletar a lista de contratos do Portal de Transparência da Prefeitura de SP.",
      "acceptanceCriteria": [
        "Identificar endpoints/páginas do portal de SP com lista de contratos",
        "Scraper que extrai: número do contrato, objeto (resumo), valor, fornecedor, data",
        "Suporte a paginação",
        "Rate limiting para não sobrecarregar o portal",
        "Salvar metadados no banco",
        "Log de execução (contratos encontrados, erros)",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-002"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-005",
      "title": "Crawler do Portal de Transparência SP - Detalhes e PDFs",
      "description": "Como sistema, quero baixar os detalhes completos e PDFs de cada contrato identificado.",
      "acceptanceCriteria": [
        "Acessar página de detalhes de cada contrato",
        "Extrair: partes, datas (início, fim), valor total, aditivos, modalidade",
        "Baixar PDF do contrato original",
        "Upload do PDF para cloud storage",
        "Atualizar registro no banco com URL do documento",
        "Fila de processamento para contratos pendentes",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-004",
        "US-003"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-006",
      "title": "Parser de PDFs de contratos",
      "description": "Como sistema, quero extrair texto dos PDFs de contratos para análise por AI.",
      "acceptanceCriteria": [
        "Integração com biblioteca de extração de PDF (pdf-parse ou similar)",
        "Extrair texto completo do documento",
        "Lidar com PDFs escaneados (OCR básico via Tesseract ou similar)",
        "Salvar texto extraído no banco",
        "Marcar contratos com falha de extração para revisão",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-005"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-007",
      "title": "Módulo de AI configurável",
      "description": "Como desenvolvedor, quero um módulo de AI que suporte múltiplos provedores (OpenAI, Anthropic, local) de forma configurável.",
      "acceptanceCriteria": [
        "Interface abstrata para completions (prompt → response)",
        "Implementação para OpenAI (GPT-4o, GPT-4o-mini)",
        "Implementação para Anthropic (Claude)",
        "Placeholder para modelos locais (Ollama)",
        "Configuração via variáveis de ambiente",
        "Retry com exponential backoff",
        "Logging de uso (tokens, custo estimado)",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-001"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-008",
      "title": "Geração de resumo do contrato por AI",
      "description": "Como usuário, quero ver um resumo em linguagem simples de cada contrato, explicando o que está sendo contratado, por quanto e por quem.",
      "acceptanceCriteria": [
        "Prompt estruturado para gerar resumo",
        "Resumo inclui: objeto (em linguagem simples), valor, partes, prazo, condições principais",
        "Resumo inclui: histórico de aditivos se houver",
        "Resumo inclui: contexto comparativo (valores de contratos similares)",
        "Formato consistente e legível",
        "Salvar resumo no banco vinculado ao contrato",
        "Possibilidade de regenerar resumo",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "",
      "dependsOn": [
        "US-006",
        "US-007"
      ],
      "completionNotes": "Completed by agent"
    },
    {
      "id": "US-009",
      "title": "Classificação automática de contratos",
      "description": "Como sistema, quero classificar contratos por categoria para permitir comparações relevantes.",
      "acceptanceCriteria": [
        "Usar código de classificação oficial quando disponível (natureza de despesa)",
        "AI classifica por palavras-chave do objeto quando código não disponível",
        "Categorias principais: obras, serviços, TI, saúde, educação, outros",
        "Salvar categoria no banco",
        "Permitir correção manual da categoria",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 9,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-007",
        "US-006"
      ]
    },
    {
      "id": "US-010",
      "title": "Cálculo do score de anomalia - Valor",
      "description": "Como sistema, quero identificar contratos com valores significativamente acima da média de contratos similares.",
      "acceptanceCriteria": [
        "Calcular média e desvio padrão de contratos da mesma categoria",
        "Identificar contratos > 2 desvios padrão acima da média",
        "Considerar período temporal (comparar com mesmo ano/período)",
        "Gerar score parcial (0-25) para este critério",
        "Salvar justificativa (\"Valor 47% acima da média de contratos similares\")",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 10,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-009"
      ]
    },
    {
      "id": "US-011",
      "title": "Cálculo do score de anomalia - Aditivos",
      "description": "Como sistema, quero identificar contratos com número excessivo de aditivos.",
      "acceptanceCriteria": [
        "Contar aditivos por contrato",
        "Calcular média de aditivos para contratos da mesma categoria",
        "Identificar contratos com aditivos > média + 1.5 desvios",
        "Considerar valor acumulado dos aditivos vs valor original",
        "Gerar score parcial (0-25) para este critério",
        "Salvar justificativa (\"5 aditivos, média da categoria é 1.2\")",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 11,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-009"
      ]
    },
    {
      "id": "US-012",
      "title": "Cálculo do score de anomalia - Concentração de fornecedor",
      "description": "Como sistema, quero identificar órgãos com concentração recorrente em um mesmo fornecedor.",
      "acceptanceCriteria": [
        "Calcular % de contratos de cada órgão por fornecedor",
        "Identificar fornecedores com > 30% dos contratos de um órgão",
        "Considerar valor total além de quantidade",
        "Gerar score parcial (0-25) para este critério",
        "Salvar justificativa (\"Fornecedor X tem 45% dos contratos do órgão Y\")",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 12,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-009"
      ]
    },
    {
      "id": "US-013",
      "title": "Cálculo do score de anomalia - Prazo atípico",
      "description": "Como sistema, quero identificar contratos com prazos incomuns para sua categoria.",
      "acceptanceCriteria": [
        "Calcular duração média de contratos por categoria",
        "Identificar contratos com prazo muito curto ou muito longo",
        "Considerar urgência declarada vs prazo",
        "Gerar score parcial (0-25) para este critério",
        "Salvar justificativa (\"Prazo de 10 dias para obra, média é 180 dias\")",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 13,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-009"
      ]
    },
    {
      "id": "US-014",
      "title": "Consolidação do score de anomalia",
      "description": "Como sistema, quero consolidar os scores parciais em um score final com categoria.",
      "acceptanceCriteria": [
        "Somar scores parciais (0-100)",
        "Atribuir categoria: Baixo (0-30), Médio (31-60), Alto (61-100)",
        "Listar quais critérios contribuíram para o score",
        "Salvar score consolidado e breakdown no banco",
        "Ordenar contratos por score para exibição",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 14,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-010",
        "US-011",
        "US-012",
        "US-013"
      ]
    },
    {
      "id": "US-015",
      "title": "API REST - Endpoints de contratos",
      "description": "Como desenvolvedor externo, quero acessar dados de contratos via API REST.",
      "acceptanceCriteria": [
        "GET /api/contracts - Lista paginada com filtros",
        "GET /api/contracts/:id - Detalhes de um contrato",
        "Filtros: categoria, órgão, fornecedor, período, score mínimo",
        "Ordenação: data, valor, score",
        "Resposta inclui: dados, resumo AI, score, breakdown",
        "Documentação OpenAPI/Swagger",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 15,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-014",
        "US-008"
      ]
    },
    {
      "id": "US-016",
      "title": "API REST - Endpoints de comparação",
      "description": "Como desenvolvedor externo, quero comparar contratos similares via API.",
      "acceptanceCriteria": [
        "GET /api/contracts/:id/similar - Contratos similares",
        "Parâmetros: período (histórico), região (quando expandir)",
        "Resposta inclui: lista de contratos similares com valores",
        "Inclui estatísticas: média, mediana, min, max da categoria",
        "Documentação OpenAPI/Swagger",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 16,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-015"
      ]
    },
    {
      "id": "US-017",
      "title": "API REST - Endpoints de fornecedores e órgãos",
      "description": "Como desenvolvedor externo, quero consultar dados agregados por fornecedor e órgão.",
      "acceptanceCriteria": [
        "GET /api/suppliers - Lista de fornecedores",
        "GET /api/suppliers/:id - Detalhes e contratos do fornecedor",
        "GET /api/agencies - Lista de órgãos",
        "GET /api/agencies/:id - Detalhes e contratos do órgão",
        "Inclui métricas: total de contratos, valor total, score médio",
        "Documentação OpenAPI/Swagger",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 17,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-015"
      ]
    },
    {
      "id": "US-018",
      "title": "Interface Web - Setup e estrutura",
      "description": "Como desenvolvedor, quero a aplicação web configurada com framework e componentes base.",
      "acceptanceCriteria": [
        "Framework React com Vite ou Next.js",
        "TailwindCSS configurado",
        "Shadcn/UI configurado",
        "Componentes base: Layout, Header, Footer",
        "Roteamento configurado",
        "Integração com API (fetch/axios configurado)",
        "Página inicial com placeholder",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 18,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-015"
      ]
    },
    {
      "id": "US-019",
      "title": "Interface Web - Lista de contratos",
      "description": "Como jornalista, quero ver uma lista de contratos com filtros e ordenação para encontrar rapidamente o que procuro.",
      "acceptanceCriteria": [
        "Tabela de contratos com colunas: objeto, valor, fornecedor, órgão, data, score",
        "Filtros: categoria, órgão, fornecedor, período",
        "Filtro por score mínimo (slider ou input)",
        "Ordenação por qualquer coluna",
        "Paginação",
        "Indicador visual de score (cor por categoria)",
        "Link para detalhes de cada contrato",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 19,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-018"
      ]
    },
    {
      "id": "US-020",
      "title": "Interface Web - Detalhes do contrato",
      "description": "Como jornalista, quero ver todos os detalhes de um contrato, incluindo resumo AI e breakdown do score.",
      "acceptanceCriteria": [
        "Resumo AI em destaque no topo",
        "Dados completos: partes, valores, datas, aditivos",
        "Score visual com breakdown (quais critérios contribuíram)",
        "Lista de aditivos com valores e datas",
        "Link para PDF original",
        "Seção de contratos similares (preview)",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 20,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-019",
        "US-016"
      ]
    },
    {
      "id": "US-021",
      "title": "Interface Web - Comparação de contratos",
      "description": "Como pesquisador, quero comparar um contrato com similares para entender se os valores são típicos.",
      "acceptanceCriteria": [
        "Visualização de contratos similares (tabela ou cards)",
        "Gráfico comparativo (valor do contrato vs média/mediana)",
        "Filtro por período (últimos 1, 2, 5 anos)",
        "Estatísticas da categoria: média, mediana, min, max",
        "Destaque visual para posição do contrato atual",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 21,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-020"
      ]
    },
    {
      "id": "US-022",
      "title": "Interface Web - Página de fornecedor",
      "description": "Como jornalista, quero ver o perfil de um fornecedor com todos os seus contratos e métricas.",
      "acceptanceCriteria": [
        "Dados do fornecedor: CNPJ, razão social",
        "Métricas: total de contratos, valor total, órgãos atendidos",
        "Indicador de concentração (se > 30% em algum órgão)",
        "Lista de contratos do fornecedor",
        "Gráfico de evolução temporal (contratos por ano)",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 22,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-019",
        "US-017"
      ]
    },
    {
      "id": "US-023",
      "title": "Interface Web - Página de órgão",
      "description": "Como pesquisador, quero ver o perfil de um órgão com seus contratos e principais fornecedores.",
      "acceptanceCriteria": [
        "Dados do órgão",
        "Métricas: total de contratos, valor total, score médio",
        "Top fornecedores (com % de participação)",
        "Lista de contratos do órgão",
        "Indicador de concentração se houver",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 23,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-019",
        "US-017"
      ]
    },
    {
      "id": "US-024",
      "title": "Interface Web - Busca global",
      "description": "Como usuário, quero buscar contratos por texto livre para encontrar rapidamente o que procuro.",
      "acceptanceCriteria": [
        "Campo de busca no header",
        "Busca por: objeto do contrato, fornecedor, órgão",
        "Resultados agrupados por tipo (contratos, fornecedores, órgãos)",
        "Autocomplete com sugestões",
        "Página de resultados com filtros",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 24,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-019"
      ]
    },
    {
      "id": "US-025",
      "title": "Job de atualização automática",
      "description": "Como sistema, quero atualizar automaticamente os dados de contratos periodicamente.",
      "acceptanceCriteria": [
        "Job agendado (cron) para rodar diariamente",
        "Coletar novos contratos desde última execução",
        "Atualizar contratos existentes se houver mudanças",
        "Recalcular scores afetados por novos dados",
        "Log de execução com métricas (novos, atualizados, erros)",
        "Alertas em caso de falha",
        "pnpm typecheck passes",
        "pnpm lint passes"
      ],
      "priority": 25,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-014",
        "US-005"
      ]
    },
    {
      "id": "US-026",
      "title": "Documentação da API",
      "description": "Como desenvolvedor externo, quero documentação completa da API para integrar meus sistemas.",
      "acceptanceCriteria": [
        "Swagger/OpenAPI spec completa",
        "Página de documentação interativa (/api/docs)",
        "Exemplos de requisição e resposta",
        "Descrição de todos os filtros e parâmetros",
        "Guia de início rápido no README",
        "pnpm typecheck passes",
        "pnpm lint passes",
        "Verificar no browser usando dev-browser skill"
      ],
      "priority": 26,
      "passes": false,
      "notes": "",
      "dependsOn": [
        "US-015",
        "US-016",
        "US-017"
      ]
    }
  ],
  "metadata": {
    "updatedAt": "2026-01-31T21:39:20.668Z"
  }
}